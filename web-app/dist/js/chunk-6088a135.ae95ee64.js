(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6088a135"],{1276:function(t,e,a){"use strict";var s=a("d784"),n=a("44e7"),r=a("825a"),i=a("1d80"),l=a("4840"),c=a("8aa5"),o=a("50c4"),u=a("14c3"),p=a("9263"),d=a("d039"),f=[].push,v=Math.min,h=4294967295,k=!d((function(){return!RegExp(h,"y")}));s("split",2,(function(t,e,a){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var s=String(i(this)),r=void 0===a?h:a>>>0;if(0===r)return[];if(void 0===t)return[s];if(!n(t))return e.call(s,t,r);var l,c,o,u=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,k=new RegExp(t.source,d+"g");while(l=p.call(k,s)){if(c=k.lastIndex,c>v&&(u.push(s.slice(v,l.index)),l.length>1&&l.index<s.length&&f.apply(u,l.slice(1)),o=l[0].length,v=c,u.length>=r))break;k.lastIndex===l.index&&k.lastIndex++}return v===s.length?!o&&k.test("")||u.push(""):u.push(s.slice(v)),u.length>r?u.slice(0,r):u}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var n=i(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,n,a):s.call(String(n),e,a)},function(t,n){var i=a(s,t,this,n,s!==e);if(i.done)return i.value;var p=r(t),d=String(this),f=l(p,RegExp),g=p.unicode,b=(p.ignoreCase?"i":"")+(p.multiline?"m":"")+(p.unicode?"u":"")+(k?"y":"g"),m=new f(k?p:"^(?:"+p.source+")",b),w=void 0===n?h:n>>>0;if(0===w)return[];if(0===d.length)return null===u(m,d)?[d]:[];var _=0,x=0,y=[];while(x<d.length){m.lastIndex=k?x:0;var D,C=u(m,k?d:d.slice(x));if(null===C||(D=v(o(m.lastIndex+(k?0:x)),d.length))===_)x=c(d,x,g);else{if(y.push(d.slice(_,x)),y.length===w)return y;for(var I=1;I<=C.length-1;I++)if(y.push(C[I]),y.length===w)return y;x=_=D}}return y.push(d.slice(_)),y}]}),!k)},2095:function(t,e,a){"use strict";a.d(e,"b",(function(){return p})),a.d(e,"a",(function(){return d}));a("99af");var s=function(t){return t>=10?t:"0".concat(t)},n=1e3,r=60*n,i=60*r,l=24*i,c=30*l,o=12*c,u=function(t){if(!t)return{};var e=new Date(parseInt(t)),a={y:e.getFullYear(),m:e.getMonth()+1,d:e.getDate(),h:e.getHours(),mi:e.getMinutes(),s:e.getSeconds()};return a},p=function(t){var e=u(t),a=e.y,n=e.m,r=e.d,i=e.h,l=e.mi;return"".concat(a,"/").concat(s(n),"/").concat(s(r)," ").concat(s(i),":").concat(s(l))},d=function(t){if(!t)return"日期格式不正确";var e=parseInt(t)-Date.now();switch(!0){case e<0:return'<span style="color:red">已超时!</span>';case e>=o:return'<span style="color:#66BB6A">'.concat(parseInt(e/o),"年后</span>");case e>=c:return'<span style="color:#66BB6A">'.concat(parseInt(e/c),"个多月后</span>");case e>=l:return'<span style="color:#9CCC65">还有'.concat(parseInt(e/l),"天</span>");case e>=i:return'<span style="color:#FFA726">'.concat(parseInt(e/i),"小时后</span>");case e>=r:return'<span style="color:#FF7043">'.concat(parseInt(e/r),"分钟后</span>");default:return'<span style="color:#E91E63">不到一分钟了!</span>'}}},"2c1e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"detail"},[a("h3",[t._v(t._s(t.taskDetail.title)+"(ID:"+t._s(t.taskDetail.taskId)+")")]),a("div",[a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("工作流:")]),a("span",{staticClass:"value"},[t.taskDetail.flow?a("Flow",{staticStyle:{"margin-left":"90px"},attrs:{flow:t.taskDetail.flow,nowFlow:t.taskDetail.nowFlow,taskId:t.taskDetail.taskId}}):a("span",[t._v("此任务无工作流")])],1)]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("状态:")]),a("span",{staticClass:"value"},[a("Status",{attrs:{status:t.taskDetail.status}})],1)]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("任务日期:")]),a("span",{staticClass:"value"},[a("span",[t._v(t._s(t.formatDate(t.taskDetail.startDate)))]),t._v(" 至 "),a("span",[t._v(t._s(t.formatDate(t.taskDetail.endDate)))])])]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("成本:")]),a("span",{staticClass:"value"},[t._v(" "+t._s(t.taskDetail.cost)+"元 ")])]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("数量:")]),a("span",{staticClass:"value"},[t._v(" "+t._s(t.taskDetail.quantity)+"个 ")])]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("负责人:")]),a("span",{staticClass:"value"},[a("el-select",{attrs:{size:"mini"},on:{change:t.changeResPerson},model:{value:t.taskDetail.responsePerson,callback:function(e){t.$set(t.taskDetail,"responsePerson",e)},expression:"taskDetail.responsePerson"}},t._l(t.resPersonList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name+"("+t.account+")",value:t.id}})})),1)],1)]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("描述:")]),a("span",{staticClass:"value"},[t._v(" "+t._s(t.taskDetail.description||"-"))])]),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("备注:")]),a("span",{staticClass:"value"},[t._v(" "+t._s(t.taskDetail.comment||"-"))])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("相关文件:")]),t.taskDetail.files&&t.taskDetail.files.length>0?a("span",{staticClass:"value",staticStyle:{padding:"0 40px 0 0"}},t._l(t.taskDetail.files,(function(e,s){return a("el-link",{key:s,attrs:{type:"primary",href:e.path,download:"",target:"_blank"}},[t._v(t._s(e.sourceName))])})),1):t._e(),a("span",{staticClass:"value"},[t._v("-")])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("标签:")]),t.tags.length>0?a("span",{staticClass:"value"},t._l(t.tags,(function(e,s){return a("el-tag",{key:s,staticStyle:{margin:"5px"},attrs:{type:e.type}},[t._v(t._s(e.text))])})),1):a("span",{staticClass:"value"},[t._v("-")])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("联系方式:")]),a("span",{staticClass:"value"},[t._v(t._s(t.taskDetail.phone||"-"))])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("联系地址:")]),a("span",{staticClass:"value"},[t._v(t._s(t.taskDetail.address||"-"))])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("创建人:")]),a("span",{staticClass:"value"},[t._v(t._s(t.taskDetail.createPerson))])]),a("br"),a("p",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("创建时间:")]),a("span",{staticClass:"value"},[t._v(" "+t._s(t.formatDate(t.taskDetail.createDate)))])])]),a("br"),"/todo/detail"!=t.$route.path?a("el-card",{attrs:{"body-style":{background:"#F1F8E9"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("子任务")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){t.createTaskVisible=!0}}},[t._v("新建子任务")])],1),t.childTasks&&t.childTasks.length>0?a("el-table",{attrs:{data:t.childTasks,"empty-text":"此任务无子任务"}},[a("el-table-column",{attrs:{label:"名称",prop:"title"}}),a("el-table-column",{attrs:{label:"负责人",prop:"responsePersonName"}}),a("el-table-column",{attrs:{label:"状态",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("Status",{attrs:{status:t.row.status}})]}}],null,!1,4023936061)}),a("el-table-column",{attrs:{label:"截至时间",prop:"endDate"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{domProps:{innerHTML:t._s(t.btyDate(e.row.endDate))}},[t._v(" "+t._s(e.row.endDate)+" ")])}}],null,!1,2367879303)}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.makeQrcode(e.row)}}},[t._v("二维码查看")])]}}],null,!1,1278335245)}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary",size:"small"},on:{click:function(a){return t.openDetail(e.row)}}},[t._v("详情")])]}}],null,!1,3643848732)})],1):a("p",{staticStyle:{"text-align":"center"}},[t._v("此任务无子任务")])],1):t._e(),a("el-dialog",{attrs:{visible:t.createTaskVisible,width:"80%",top:"20px",title:"建立"+t.taskDetail.title+"的子任务","destroy-on-close":""},on:{"update:visible":function(e){t.createTaskVisible=e}}},[a("CreateTask",{attrs:{fatherTask:t.taskDetail.taskId}})],1)],1),a("el-dialog",{attrs:{title:"任务二维码",visible:t.taskQrCodeVisible,width:"296px"},on:{"update:visible":function(e){t.taskQrCodeVisible=e}}},[a("div",{attrs:{id:"qrcode"}})])],1)},n=[],r=(a("99af"),a("7db0"),a("caad"),a("d81d"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("96cf"),a("1da1")),i=a("ea7f"),l=a("5723"),c=a("2095"),o=a("6272"),u=a("d044"),p=a.n(u),d=a("a2dd"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-steps",{attrs:{active:t.isFinished?"":t.active,direction:"vertical",space:"50px","process-status":"process","finish-status":"success"}},t._l(t.flowList,(function(e,s){return a("el-step",{key:s,attrs:{title:e,statue:t.isFinished?"success":""}})})),1),t.flowList.length>0&&t.isIng?a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.nextFlow}},[t._v("下一步")]),a("el-select",{attrs:{placeholder:"异常跳转"},model:{value:t.activeFlow,callback:function(e){t.activeFlow=e},expression:"activeFlow"}},t._l(t.flowList,(function(t,e){return a("el-option",{key:e,attrs:{value:t,label:t}})})),1)],1):t._e()],1)},v=[],h=(a("c740"),{props:["flow","nowFlow","taskId"],computed:{flowList:function(){return this.flow?this.flow.split(";"):[]},isIng:function(){return console.log(this.$route),"IngTaskDetail"==this.$route.name},active:function(){var t=this;return this.flowList.findIndex((function(e){return e===t.activeFlow}))},isFinished:function(){return"FinishedTaskDetail"==this.$route.name||"AllTaskDetail"==this.$route.name}},watch:{activeFlow:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.activeFlow){e.next=2;break}return e.abrupt("return");case 2:return a={taskId:t.taskId,flow:t.activeFlow},e.next=5,Object(i["c"])(a);case 5:s=e.sent,t.$message.success("成功"),console.log("res",s);case 8:case"end":return e.stop()}}),e)})))()}},data:function(){return{activeFlow:""}},created:function(){console.log("this.nowFlow",this.nowFlow),this.activeFlow=this.nowFlow},methods:{nextFlow:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.active+1,!(a<t.flowList.length)){e.next=4;break}return t.activeFlow=t.flowList[a],e.abrupt("return");case 4:return s={status:3,taskId:t.taskId},e.next=7,Object(i["b"])(s);case 7:if(n=e.sent,200===n.code){e.next=11;break}return t.$message.error("失败"),e.abrupt("return");case 11:t.$router.push({name:"FinishedTask"}),console.log("res",n);case 13:case"end":return e.stop()}}),e)})))()}}}),k=h,g=a("2877"),b=Object(g["a"])(k,f,v,!1,null,null,null),m=b.exports,w={components:{CreateTask:o["default"],Status:d["a"],Flow:m},data:function(){return{taskDetail:{},createTaskVisible:!1,childTasks:[],taskQrCodeVisible:!1,resPersonList:[],loading:!1}},computed:{taskId:function(){return this.$route.query.taskId},status:function(){return this.$route.query.status},tags:function(){return this.taskDetail.tags?this.taskDetail.tags.split(";").map((function(t){var e=t.split(",");return{text:e[0],type:e[1]}})):[]}},watch:{"$route.query":{handler:function(){this.getTaskDetail()}}},methods:{formatDate:c["b"],btyDate:c["a"],changeResPerson:function(t){var e=this,a=this,s=this.resPersonList.find((function(t){return t.id==e.taskDetail.responsePerson}));this.$confirm("负责人将变更至".concat(s.name,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function s(){var n,r,l;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n={taskId:a.taskDetail.taskId,newPerson:t},s.next=3,Object(i["d"])(n);case 3:if(r=s.sent,200===r.code){s.next=7;break}return e.$message.error("变更失败"),s.abrupt("return");case 7:e.$message.success("变更成功，如果你不是主管，五秒后，你将失去此任务的权限"),l=setTimeout((function(){clearTimeout(l),a.$router.back()}),3e3);case 9:case"end":return s.stop()}}),s)}))))},getResponsiblePersonList:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["d"])();case 2:if(a=e.sent,200===a.code){e.next=6;break}return t.$message.error(a.msg),e.abrupt("return");case 6:t.resPersonList=a.data;case 7:case"end":return e.stop()}}),e)})))()},getTaskDetail:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s,n,r,l,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,a={taskId:t.taskId},e.next=4,Object(i["h"])(a);case 4:if(s=e.sent,t.loading=!1,t.childTasks=[],t.taskDetail=s.data,!t.taskDetail.childTasks){e.next=22;break}n=t.taskDetail.childTasks.split(","),r=0;case 11:if(!(r<n.length)){e.next=22;break}return l={taskId:n[r]},e.next=15,Object(i["h"])(l);case 15:if(c=e.sent,200===c.code){e.next=18;break}return e.abrupt("return");case 18:t.childTasks.push(c.data);case 19:r++,e.next=11;break;case 22:case"end":return e.stop()}}),e)})))()},makeQrcode:function(t){this.taskQrCodeVisible=!0,this.$nextTick((function(){var e=document.getElementById("qrcode");e.innerHTML="";var a=location.host.includes("127.0.0.1")?location.host:"".concat(location.host,"/bsweb"),s="http://".concat(a,"/#/taskDetail?taskId=").concat(t.taskId);new p.a("qrcode",{text:s,render:"canvas",background:"#f0f",foreground:"#ff0"})}))},openDetail:function(t){var e={1:"TodoTaskDetail",2:"IngTaskDetail",3:"FinishedTaskDetail",10:"AllTaskDetail"};console.log("statusMap[row.status],",e[t.status]),this.$router.push({name:e[t.status],query:{taskId:t.taskId},params:t})}},created:function(){this.getTaskDetail(),this.getResponsiblePersonList()}},_=w,x=(a("4849"),Object(g["a"])(_,s,n,!1,null,"11005717",null));e["default"]=x.exports},"35c0":function(t,e,a){},4849:function(t,e,a){"use strict";a("35c0")},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var s=a("1d80"),n=a("5899"),r="["+n+"]",i=RegExp("^"+r+r+"*"),l=RegExp(r+r+"*$"),c=function(t){return function(e){var a=String(s(e));return 1&t&&(a=a.replace(i,"")),2&t&&(a=a.replace(l,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(t,e,a){var s=a("861d"),n=a("d2bb");t.exports=function(t,e,a){var r,i;return n&&"function"==typeof(r=e.constructor)&&r!==a&&s(i=r.prototype)&&i!==a.prototype&&n(t,i),t}},"7db0":function(t,e,a){"use strict";var s=a("23e7"),n=a("b727").find,r=a("44d2"),i=a("ae40"),l="find",c=!0,o=i(l);l in[]&&Array(1)[l]((function(){c=!1})),s({target:"Array",proto:!0,forced:c||!o},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r(l)},a2dd:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tag",{attrs:{type:t.types[t.status],size:"small"}},[t._v(" "+t._s(t.texts[t.status])+" ")])},n=[],r=(a("a9e3"),{1:"info",2:"",3:"success",999:"danger"}),i={1:"待办",2:"进行中",3:"已完成",999:"取消"},l={props:{status:{type:Number,default:0}},data:function(){return{types:r,texts:i}}},c=l,o=a("2877"),u=Object(o["a"])(c,s,n,!1,null,null,null);e["a"]=u.exports},a9e3:function(t,e,a){"use strict";var s=a("83ab"),n=a("da84"),r=a("94ca"),i=a("6eeb"),l=a("5135"),c=a("c6b6"),o=a("7156"),u=a("c04e"),p=a("d039"),d=a("7c73"),f=a("241c").f,v=a("06cf").f,h=a("9bf2").f,k=a("58a8").trim,g="Number",b=n[g],m=b.prototype,w=c(d(m))==g,_=function(t){var e,a,s,n,r,i,l,c,o=u(t,!1);if("string"==typeof o&&o.length>2)if(o=k(o),e=o.charCodeAt(0),43===e||45===e){if(a=o.charCodeAt(2),88===a||120===a)return NaN}else if(48===e){switch(o.charCodeAt(1)){case 66:case 98:s=2,n=49;break;case 79:case 111:s=8,n=55;break;default:return+o}for(r=o.slice(2),i=r.length,l=0;l<i;l++)if(c=r.charCodeAt(l),c<48||c>n)return NaN;return parseInt(r,s)}return+o};if(r(g,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var x,y=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof y&&(w?p((function(){m.valueOf.call(a)})):c(a)!=g)?o(new b(_(e)),a,y):_(e)},D=s?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),C=0;D.length>C;C++)l(b,x=D[C])&&!l(y,x)&&h(y,x,v(b,x));y.prototype=m,m.constructor=y,i(n,g,y)}},c740:function(t,e,a){"use strict";var s=a("23e7"),n=a("b727").findIndex,r=a("44d2"),i=a("ae40"),l="findIndex",c=!0,o=i(l);l in[]&&Array(1)[l]((function(){c=!1})),s({target:"Array",proto:!0,forced:c||!o},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r(l)}}]);
//# sourceMappingURL=chunk-6088a135.ae95ee64.js.map